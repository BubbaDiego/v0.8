{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block extra_styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

<style>
  .card-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
  }

  .card {
    border-radius: 1rem;
    width: 140px;
    height: 72px;
    display: flex;
    flex-direction: column;
    justify-content: start;
    align-items: center;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    text-align: center;
    padding: 0.35rem 0.5rem;
    transition: background-color 0.3s ease;
  }

  .card .icon {
    font-size: 1.2rem;
    margin-top: 0.35rem;
    margin-bottom: 0.4rem;
  }

  .card .value {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.4rem;
  }

  .card .label {
    font-size: 0.7rem;
  }

  .universal-box-wrapper {
    background-color: #eef5fc;
    border-radius: 1rem;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  }

  /* Color classes */
  .card.red {
    background: #f8d7da;
    color: #721c24;
  }
  .card.yellow {
    background: #fff3cd;
    color: #856404;
  }
  .card.green {
    background: #d4edda;
    color: #155724;
  }

  .box-row.centered {
    justify-content: center;
    margin-bottom: 1.5rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid pt-4">

  <!-- ðŸ“Š MONITOR METRICS -->
  <div class="universal-box-wrapper">
    <div class="box-row centered">
      {% include "partials/_universal_monitor_bar.html" %}
    </div>
  </div>

  <!-- ðŸ’° STATUS METRICS -->
  <div class="universal-box-wrapper">
    <div class="box-row centered">
      {% include "partials/_universal_status_bar.html" %}
    </div>
  </div>

  <!-- ðŸ”» POSITIONS + LIQUIDATION -->
  <div class="box-row">
    {% include "partials/_positions.html" %}
    {% include "partials/_liquidation.html" %}
  </div>

  <!-- ðŸ“ˆ GRAPH + PIE -->
  <div class="box-row">
    {% include "partials/_graph.html" %}
    {% include "partials/_pie.html" %}
  </div>

</div>
{% endblock %}

{% block extra_scripts %}
{{ super() }}
<script>
  window.TOTAL_PORTFOLIO_LIMITS = {{ portfolio_limits | tojson }};
  var GRAPH_DATA_URL = "{{ url_for('dashboard.api_graph_data') }}";
  var SIZE_COMPOSITION_URL = "{{ url_for('dashboard.api_size_composition') }}";
  var COLLATERAL_COMPOSITION_URL = "{{ url_for('dashboard.api_collateral_composition') }}";
</script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script src="{{ url_for('static', filename='js/freshness_timer.js') }}"></script>
{% endblock %}
