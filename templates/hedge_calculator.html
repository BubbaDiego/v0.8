<!-- templates/hedge_calculator.html -->

<script src="../static/js/freshness_timer.js"></script>
<link rel="stylesheet" href="../static/css/dashboard.css">{% extends "base.html" %}

{% block title %}Hedge Calculator{% endblock %}

{% block extra_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/hedge_calculator.css') }}">
{% endblock %}

{% block content %}
<div class="container-fluid">
  <!-- Hedge Calculator UI will be dynamically populated -->
  <div id="hedgeCalculatorContainer"></div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  // üõ°Ô∏è Inject global variables for Hedge Calculator
  const longPositions = {{ long_positions | tojson | safe }};
  const shortPositions = {{ short_positions | tojson | safe }};
  const modifiersData = {{ modifiers | tojson | safe }};
</script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const scripts = [
      "{{ url_for('static', filename='js/hedge_data.js') }}",
      "{{ url_for('static', filename='js/hedge_ui.js') }}",
      "{{ url_for('static', filename='js/hedge_logic.js') }}"
    ];

    let loadedScripts = 0;

    function tryInit() {
      loadedScripts++;
      if (loadedScripts === scripts.length) {
        console.log("‚úÖ All Hedge Calculator scripts fully loaded.");
        HedgeData.init();
      }
    }

    scripts.forEach(src => {
      const script = document.createElement('script');
      script.src = src;
      script.onload = tryInit;
      script.onerror = function() {
        console.error(`üö® Failed to load ${src}`);
      };
      document.body.appendChild(script);
    });
  });
</script>
{% endblock %}

